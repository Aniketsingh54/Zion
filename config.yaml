# ─────────────────────────────────────────────────────────
# Zion Configuration
# ─────────────────────────────────────────────────────────

# Processes to ignore in exec telemetry (shell prompt noise, IDE, etc.)
whitelist:
  # Processes allowed to use ptrace / read /proc/[pid]/* (LSM enforcement)
  ptrace_allowed:
    - ps
    - top
    - htop
    - cat
    - head
    - tail
    - grep
    - awk
    - sed
    - wc
    - less
    - more
    - antigravity
    - code
    - node
    - python3
    - python
    - chrome
    - electron
    - systemd
    - pidof
    - pgrep
    - pkill
    - lsof
    - ss
    - netstat
    - who
    - w
    - uptime
    - free
    - vmstat
    - iostat
    - sar
    - snap
    - cpuUsage.sh

  # Processes to ignore in exec telemetry (shell prompt noise, IDE, etc.)
  exec:
    # Shell prompt / powerline
    - ip
    - cut
    - head
    - hostname
    - uname
    - sed
    - awk
    - grep
    - tr
    - wc
    - tput
    - dircolors
    - sh
    - cat
    - sleep
    # Status bar
    - which
    - ps
    - cpuUsage.sh
    # IDE / tooling
    - git
    - getent
    - code
    - node
    - gopls

  # Binaries allowed to escalate to root via setuid(0)
  escalation:
    - sudo
    - su
    - pkexec
    - doas
    - login
    - sshd
    - cron
    - polkitd
    - newgrp
    - unix_chkpwd

  # Processes allowed to read /etc/shadow, /etc/gshadow
  credential_readers:
    - sshd
    - login
    - passwd
    - chpasswd
    - unix_chkpwd
    - su
    - sudo

  # Processes allowed to write to /var/log/
  log_writers:
    - logrotate
    - rsyslogd
    - rsyslog
    - systemd-journald
    - syslog-ng

  # Processes allowed to modify crontab / shell profiles
  persistence_writers:
    - cron
    - anacron
    - vim
    - nano
    - vi

  # Processes allowed to use memfd_create (display servers, browsers, etc.)
  memfd_allowed:
    - Xorg
    - Xwayland
    - pulseaudio
    - pipewire
    - pipewire-pulse
    - wireplumber
    - gnome-shell
    - gdm
    - systemd
    - chrome
    - chrome_crashpad
    - code
    - node
    - python3
    - python
    - electron
    - cinnamon
    - nautilus

# BPF-LSM Prevention Policy (deterministic blocking — no race conditions)
# Run with: sudo ./zion --enforce
prevention:
  enforce: false              # Set true or use --enforce flag to enable
  blocked_binaries: []        # Binaries to block from executing (e.g., ["ncat", "socat"])

# Response settings
response:
  auto_kill: true           # Automatically kill CRITICAL threats
  capture_traffic: true     # Capture pcap on threat detection
  capture_duration: 60      # Seconds of traffic to capture
  enforcer_socket: /tmp/zion_enforcer.sock

# JSON event logging (for forensic review / SIEM ingestion)
logging:
  enabled: true
  directory: ./logs
  format: jsonl             # JSONL — one JSON object per line

# Show all exec events (including whitelisted) on console
verbose: false
