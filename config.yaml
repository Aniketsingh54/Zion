# ─────────────────────────────────────────────────────────
# Zion Configuration
# ─────────────────────────────────────────────────────────

# Processes to ignore in exec telemetry (shell prompt noise, IDE, etc.)
whitelist:
  exec:
    # Shell prompt / powerline
    - ip
    - cut
    - head
    - hostname
    - uname
    - sed
    - awk
    - grep
    - tr
    - wc
    - tput
    - dircolors
    - sh
    - cat
    - sleep
    # Status bar
    - which
    - ps
    - cpuUsage.sh
    # IDE / tooling
    - git
    - getent
    - code
    - node
    - gopls

  # Binaries allowed to escalate to root via setuid(0)
  escalation:
    - sudo
    - su
    - pkexec
    - doas
    - login
    - sshd
    - cron
    - polkitd
    - newgrp
    - unix_chkpwd

  # Processes allowed to read /etc/shadow, /etc/gshadow
  credential_readers:
    - sshd
    - login
    - passwd
    - chpasswd
    - unix_chkpwd
    - su
    - sudo

  # Processes allowed to write to /var/log/
  log_writers:
    - logrotate
    - rsyslogd
    - rsyslog
    - systemd-journald
    - syslog-ng

  # Processes allowed to modify crontab / shell profiles
  persistence_writers:
    - cron
    - anacron
    - vim
    - nano
    - vi

# Response settings
response:
  auto_kill: true           # Automatically kill CRITICAL threats
  capture_traffic: true     # Capture pcap on threat detection
  capture_duration: 60      # Seconds of traffic to capture
  enforcer_socket: /tmp/zion_enforcer.sock

# JSON event logging (for forensic review / SIEM ingestion)
logging:
  enabled: true
  directory: ./logs
  format: jsonl             # JSONL — one JSON object per line

# Show all exec events (including whitelisted) on console
verbose: false
